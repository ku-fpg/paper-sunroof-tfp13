% This is LLNCS.DEM the demonstration file of
% the LaTeX macro package from Springer-Verlag
% for Lecture Notes in Computer Science,
% version 2.4 for LaTeX2e as of 16. April 2010
%
\documentclass{llncs}
%
\usepackage{amsfonts}
\usepackage{comment}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

\newcommand{\SunroofAnalog}[1]{#1\ensuremath{_\downarrow}}
\newcommand{\HaskellAnalog}[1]{#1\ensuremath{_\uparrow}}

\newcommand{\NOTE}[1]{{\Large\textbf{NOTE:}\ #1}}
\newcommand{\TODO}[1]{{\textbf{TODO:}\ #1}}
\newcommand{\Src}[1]{{\tt{#1}}}

\newcommand{\IO}{\Src{IO}}
\newcommand{\JS}{\Src{JS}}
\newcommand{\JSI}{\Src{JSI}}
\newcommand{\JSA}{\ensuremath{\Src{JS}_\Src{A}}}
\newcommand{\JSB}{\ensuremath{\Src{JS}_\Src{B}}}

\newcommand{\Figure}[3]{%
\FigureS{#1}{#2}{#3}{scale=0.55,clip=true,trim=0.45cm 0.45cm 0.45cm 0.45cm}
}

\newcommand{\FigureS}[4]{%
\begin{figure}[h]%
\vspace{-0.5cm}%
\begin{center}%
\includegraphics[#4]{#2}%
\vspace{-0.5cm}%
\end{center}%
\caption{#3}%
\label{#1}%
\vspace{-0.5cm}%
\end{figure}%
}

\begin{document}
%
\title{Sunroof: A Monadic DSL to Generate JavaScript}
%\subtitle{}
%
\titlerunning{Sunroof}  % abbreviated title (for running head)
%                                     also used for the TOC unless
%                                     \toctitle is used
%
\author{Jan Bracker\inst{1,2}  \and Andy Gill\inst{1}}
%
\authorrunning{Jan Bracker \and Andy Gill} % abbreviated author list (for running head)
%
%%%% list of authors for the TOC (use if author list has to be modified)
\tocauthor{Jan Bracker, Andy Gill}
%
\institute{%
ITTC / EECS \\
The University of Kansas\\
Lawrence, KS 66045\\
~\\
\and
Institut f{\"u}r Informatik\\
Christian-Albrechts-Universit{\"a}t\\
Kiel, Germany}

\maketitle

\begin{abstract}        
\input{sections/abstract}
\keywords{DSLs, JavaScript, Web Technologies, Cloud Computing}
\end{abstract}
%
\input{sections/introduction}

\begin{comment}
\section{Example Sunroof Program}
\label{sec:simple-example}

A simple drawing program, that we build up step by step.
Perhaps bouncing ball.
Perhaps drawing line.
\end{comment}

\input{sections/js-monad}

\input{sections/object-model}

\input{sections/functions-continuations}

\input{sections/threading-model}

\input{sections/compiler}

\input{sections/server}

\input{sections/extended-example}

\section{Background - RESOURCE COLLECTION}
\label{sec:background}

We chose to implement Sunroof as deep embedded DSL for different
reasons. Porting a compiler, like GHC, to Javascript would have
cost a lot of effort. There is no clear way to port the existing
API and there are many language features that would be difficult to
translate. Providing a foreign function interface would 
introduce the cost of translating back- and forward. 
\TODO{Not even sure how this would work or where cost comes in.}
Another possibility would be to develop a custom language. 
Besides that people would need to learn a third language for this 
approach, it would involve effort similar to porting a compiler.
As a deep embedded DSL people only have to know Haskell to learn
the new language. The cost of developing the DSL remains light, 
because we can build upon a mature language and its features.

Choices when compiling to Javascript
\begin{itemize}
\item Port a compiler to Javascript - issues, mismatching API, other efforts.
\item Provide an FFI - back and forward cost.
\item Compile a custom, cut down FP language. - example
\item DSL, restrictive, syntactically, how do we handle binding?
\end{itemize}

\subsection{Basic Idea}

As we have seen in the previous example application Sunroof uses a 
monad to model computations that can be translated to Javascript.
A binding operation is thought to be an assignment to 
a fresh variable in the reified language.



Design objectives and contributions.
\begin{itemize}
\item 
Specifically, we want to explore how similar to a native Haskell monad,
like the IO or STM monads, can we make the JS monad feel to Sunroof users.
\item We want to reflect objects. (easy)

\item We want also investigate the relationship between Haskell functions
and Javascript functions. In particular, there is an isomorphism
between monadic functions in Haskell, with the type \verb|a -> JS b|,
and Javascript functions, which we will notate using \verb|JSFunction|.
This relationship is more interesting than a Haskell synonym;
it reflects the reification options for capturing functions.
\end{itemize}

Highlights
\begin{itemize}
\item function / continuation
\item implementing wait \& fork
\end{itemize}

Up to this point, Sunroof is academically interesting, but in a real sense
we are writing Javascript using Haskell syntax, so why not just write
Javascript? There are three things we have bought by using our DSL.
\begin{itemize}
\item Typing -- We have a simple monomorphic type system that helps development of Sunroof code.
\item Haskell Abstractions --
\item Dynamic Generation -- 
\end{itemize}

\input{sections/conclusion-discussion}

\input{sections/related-work}

\input{sections/acknowledgement}

%
% ---- Bibliography ----
%


\bibliographystyle{splncs03}
\bibliography{sunroof}

\end{document}
